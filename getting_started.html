<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; galpy 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="galpy 1.0 documentation" href="index.html" />
    <link rel="next" title="Potentials in galpy" href="potential.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="potential.html" title="Potentials in galpy"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">galpy 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo-small.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#rotation-curves">Rotation curves</a></li>
<li><a class="reference internal" href="#units-in-galpy">Units in galpy</a></li>
<li><a class="reference internal" href="#orbit-integration">Orbit integration</a></li>
<li><a class="reference internal" href="#escape-velocity-curves">Escape velocity curves</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="potential.html"
                        title="next chapter">Potentials in galpy</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/getting_started.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The most basic features of galpy are its ability to display rotation
curves and perform orbit integration for arbitrary combinations of
potentials. This section introduce the most basic features of
<tt class="docutils literal"><span class="pre">galpy.potential</span></tt> and <tt class="docutils literal"><span class="pre">galpy.orbit</span></tt>.</p>
<div class="section" id="rotation-curves">
<span id="rotcurves"></span><h2>Rotation curves<a class="headerlink" href="#rotation-curves" title="Permalink to this headline">¶</a></h2>
<p>The following code example shows how to initialize a Miyamoto-Nagai disk potential and plot its rotation curve</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">MiyamotoNagaiPotential</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">=</span> <span class="n">MiyamotoNagaiPotential</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mf">0.0375</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">plotRotcurve</span><span class="p">(</span><span class="n">Rrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">grid</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">normalize=1.</span></tt> option normalizes the potential such that the
radial force is a fraction <tt class="docutils literal"><span class="pre">normalize=1.</span></tt> of the radial force
necessary to make the circular velocity 1 at R=1.</p>
<p>Similarly we can initialize other potentials and plot the combined
rotation curve</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">NFWPotential</span><span class="p">,</span> <span class="n">HernquistPotential</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">=</span> <span class="n">MiyamotoNagaiPotential</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mf">0.0375</span><span class="p">,</span><span class="n">normalize</span><span class="o">=.</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">=</span> <span class="n">NFWPotential</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span><span class="n">normalize</span><span class="o">=.</span><span class="mi">35</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="o">=</span> <span class="n">HernquistPotential</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.6</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">plotRotcurve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotRotcurve</span><span class="p">([</span><span class="n">hp</span><span class="p">,</span><span class="n">mp</span><span class="p">,</span><span class="n">np</span><span class="p">],</span><span class="n">Rrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">grid</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span><span class="n">yrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="p">])</span>
</pre></div>
</div>
<p>Note that the <tt class="docutils literal"><span class="pre">normalize</span></tt> values add up to 1. such that the circular
velocity will be 1 at R=1. The resulting rotation curve is
approximately flat. To show the rotation curves of the three
components do</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">plotRotcurve</span><span class="p">(</span><span class="n">Rrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">grid</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span><span class="n">overplot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hp</span><span class="o">.</span><span class="n">plotRotcurve</span><span class="p">(</span><span class="n">Rrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">grid</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span><span class="n">overplot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">plotRotcurve</span><span class="p">(</span><span class="n">Rrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">grid</span><span class="o">=</span><span class="mi">1001</span><span class="p">,</span><span class="n">overplot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>You&#8217;ll see the following</p>
<img alt="_images/rotcurve.png" src="_images/rotcurve.png" />
<p>As a shortcut the <tt class="docutils literal"><span class="pre">[hp,mp,np]</span></tt> Milky-Way-like potential is defined as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">MWPotential</span>
</pre></div>
</div>
<p>This is <em>not</em> the recommended Milky-Way-like potential in
<tt class="docutils literal"><span class="pre">galpy</span></tt>. The (currently) recommended Milky-Way-like potential is
<tt class="docutils literal"><span class="pre">MWPotential2014</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">MWPotential2014</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">MWPotential2014</span></tt> has a more realistic bulge model and is actually
fit to various dynamical constraints on the Milky Way (see
<a class="reference internal" href="reference/potential.html#potential-mw"><em>here</em></a> and the <tt class="docutils literal"><span class="pre">galpy</span></tt> paper).</p>
</div>
<div class="section" id="units-in-galpy">
<h2>Units in galpy<a class="headerlink" href="#units-in-galpy" title="Permalink to this headline">¶</a></h2>
<p id="units">Above we normalized the potentials such that they give a circular
velocity of 1 at R=1. These are the standard galpy units (sometimes
referred to as <em>natural units</em> in the documentation). galpy will work
most robustly when using these natural units. When using galpy to
model a real galaxy with, say, a circular velocity of 220 km/s at R=8
kpc, all of the velocities should be scaled as v= V/[220 km/s] and all
of the positions should be scaled as x = X/[8 kpc] when using galpy&#8217;s
natural units.</p>
<p>For convenience, a utility module <tt class="docutils literal"><span class="pre">bovy_conversion</span></tt> is included in
galpy that helps in converting between physical units and natural
units for various quantities. For example, in natural units the
orbital time of a circular orbit at R=1 is <span class="math">\(2\pi\)</span>; in
physical units this corresponds to</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.util</span> <span class="kn">import</span> <span class="n">bovy_conversion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="mf">2.</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">bovy_conversion</span><span class="o">.</span><span class="n">time_in_Gyr</span><span class="p">(</span><span class="mf">220.</span><span class="p">,</span><span class="mf">8.</span><span class="p">)</span>
<span class="go">0.223405444283</span>
</pre></div>
</div>
<p>or about 223 Myr. We can also express forces in various physical
units. For example, for the Milky-Way-like potential defined in galpy,
we have that the vertical force at 1.1 kpc is</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">MWPotential2014</span><span class="p">,</span> <span class="n">evaluatezforces</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">evaluatezforces</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.1</span><span class="o">/</span><span class="mf">8.</span><span class="p">,</span><span class="n">MWPotential2014</span><span class="p">)</span><span class="o">*</span><span class="n">bovy_conversion</span><span class="o">.</span><span class="n">force_in_pcMyr2</span><span class="p">(</span><span class="mf">220.</span><span class="p">,</span><span class="mf">8.</span><span class="p">)</span>
<span class="go">2.0259181908629933</span>
</pre></div>
</div>
<p>which we can also express as an equivalent surface-density by dividing
by <span class="math">\(2\pi G\)</span></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">evaluatezforces</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.1</span><span class="o">/</span><span class="mf">8.</span><span class="p">,</span><span class="n">MWPotential2014</span><span class="p">)</span><span class="o">*</span><span class="n">bovy_conversion</span><span class="o">.</span><span class="n">force_in_2piGmsolpc2</span><span class="p">(</span><span class="mf">220.</span><span class="p">,</span><span class="mf">8.</span><span class="p">)</span>
<span class="go">71.658016957792356</span>
</pre></div>
</div>
<p>Because the vertical force at the solar circle in the Milky Way at 1.1
kpc above the plane is approximately <span class="math">\(70\,(2\pi G\,
M_\odot\,\mathrm{pc}^{-2})\)</span> (e.g., <a class="reference external" href="http://adsabs.harvard.edu/abs/2013arXiv1309.0809B">2013arXiv1309.0809B</a>), this shows
that our Milky-Way-like potential has a realistic disk (at least in
this respect).</p>
<p><tt class="docutils literal"><span class="pre">bovy_conversion</span></tt> further has functions to convert densities,
masses, surface densities, and frequencies to physical units (actions
are considered to be too obvious to be included); see <a class="reference internal" href="reference/bovyconversion.html#bovyconversion"><em>here</em></a> for a full list. As a final example, the local dark
matter density in the Milky-Way-like potential is given by</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">MWPotential2014</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">dens</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span><span class="o">*</span><span class="n">bovy_conversion</span><span class="o">.</span><span class="n">dens_in_msolpc3</span><span class="p">(</span><span class="mf">220.</span><span class="p">,</span><span class="mf">8.</span><span class="p">)</span>
<span class="go">0.0075419566970079373</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">MWPotential2014</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">dens</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span><span class="o">*</span><span class="n">bovy_conversion</span><span class="o">.</span><span class="n">dens_in_gevcc</span><span class="p">(</span><span class="mf">220.</span><span class="p">,</span><span class="mf">8.</span><span class="p">)</span>
<span class="go">0.28643101789044584</span>
</pre></div>
</div>
<p>or about <span class="math">\(0.0075\,M_\odot\,\mathrm{pc}^{-3} \approx
0.3\,\mathrm{GeV\,cm}^{-3}\)</span>, in line with current measurements (e.g.,
<a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...756...89B">2012ApJ...756...89B</a>).</p>
<p>When <tt class="docutils literal"><span class="pre">galpy</span></tt> Orbits are initialized using a distance scale <tt class="docutils literal"><span class="pre">ro=</span></tt>
and a velocity scale <tt class="docutils literal"><span class="pre">vo=</span></tt> output quantities returned and plotted in
physical coordinates. Specifically, positions are are returned in
units of kpc, velocities in km/s, energies and the Jacobi integral in
(km/s)^2, the angular momentum o.L() and actions in km/s kpc,
frequencies in 1/Gyr, and times and periods in Gyr.</p>
</div>
<div class="section" id="orbit-integration">
<h2>Orbit integration<a class="headerlink" href="#orbit-integration" title="Permalink to this headline">¶</a></h2>
<p>We can also integrate orbits in all galpy potentials. Going back to a
simple Miyamoto-Nagai potential, we initialize an orbit as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.orbit</span> <span class="kn">import</span> <span class="n">Orbit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">=</span> <span class="n">MiyamotoNagaiPotential</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mf">0.0375</span><span class="p">,</span><span class="n">amp</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">=</span> <span class="n">Orbit</span><span class="p">(</span><span class="n">vxvv</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
<p>Since we gave <tt class="docutils literal"><span class="pre">Orbit()</span></tt> a five-dimensional initial condition
<tt class="docutils literal"><span class="pre">[R,vR,vT,z,vz]</span></tt>, we assume we are dealing with a three-dimensional
axisymmetric potential in which we do not wish to track the
azimuth. We then integrate the orbit for a set of times <tt class="docutils literal"><span class="pre">ts</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">mp</span><span class="p">,</span><span class="n">nethod</span><span class="o">=</span><span class="s">&#39;odeint&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we plot the resulting orbit as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Which gives</p>
<img alt="_images/mp-orbit-integration.png" src="_images/mp-orbit-integration.png" />
<p>The integrator used is not symplectic, so the energy error grows with time, but is small nonetheless</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">plotE</span><span class="p">(</span><span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/mp-orbit-E.png" src="_images/mp-orbit-E.png" />
<p>When we use a symplectic leapfrog integrator, we see that the energy
error remains constant</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">mp</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;leapfrog&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">plotE</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s">r&#39;$t$&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">r&#39;$E(t)/E(0)$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/mp-orbit-Esymp.png" src="_images/mp-orbit-Esymp.png" />
<p>Because stars have typically only orbited the center of their galaxy
tens of times, using symplectic integrators is mostly unnecessary
(compared to planetary systems which orbits millions or billions of
times). galpy contains fast integrators written in C, which can be
accessed through the <tt class="docutils literal"><span class="pre">method=</span></tt> keyword (e.g.,
<tt class="docutils literal"><span class="pre">integrate(...,method='dopr54_c')</span></tt> is a fast high-order
Dormand-Prince method).</p>
<p>When we integrate for much longer we see how the orbit fills up a
torus (this could take a minute)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">mp</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;odeint&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/mp-long-orbit-integration.png" src="_images/mp-long-orbit-integration.png" />
<p>As before, we can also integrate orbits in combinations of potentials. Assuming <tt class="docutils literal"><span class="pre">mp,</span> <span class="pre">np,</span></tt> and <tt class="docutils literal"><span class="pre">hp</span></tt> were defined as above, we can</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">ts</span><span class="p">,[</span><span class="n">mp</span><span class="p">,</span><span class="n">hp</span><span class="p">,</span><span class="n">np</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/mphpnp-orbit-integration.png" src="_images/mphpnp-orbit-integration.png" />
<p>Energy is again approximately conserved</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">plotE</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s">r&#39;$t$&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">r&#39;$E(t)/E(0)$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/mphpnp-orbit-E.png" src="_images/mphpnp-orbit-E.png" />
</div>
<div class="section" id="escape-velocity-curves">
<h2>Escape velocity curves<a class="headerlink" href="#escape-velocity-curves" title="Permalink to this headline">¶</a></h2>
<p>Just like we can plot the rotation curve for a potential or a
combination of potentials, we can plot the escape velocity curve. For
example, the escape velocity curve for the Miyamoto-Nagai disk defined
above</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="o">.</span><span class="n">plotEscapecurve</span><span class="p">(</span><span class="n">Rrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">grid</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/esc-miyamoto.png" src="_images/esc-miyamoto.png" />
<p>or of the combination of potentials defined above</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">plotEscapecurve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotEscapecurve</span><span class="p">([</span><span class="n">mp</span><span class="p">,</span><span class="n">hp</span><span class="p">,</span><span class="n">np</span><span class="p">],</span><span class="n">Rrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">grid</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/esc-comb.png" src="_images/esc-comb.png" />
<p>For the Milky-Way-like potential <tt class="docutils literal"><span class="pre">MWPotential2014</span></tt>, the
escape-velocity curve is</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plotEscapecurve</span><span class="p">(</span><span class="n">MWPotential2014</span><span class="p">,</span><span class="n">Rrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">grid</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/esc-mw14.png" src="_images/esc-mw14.png" />
<p>At the solar radius, the escape velocity is</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">vesc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vesc</span><span class="p">(</span><span class="n">MWPotential2014</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
<span class="go">2.3316389848832784</span>
</pre></div>
</div>
<p>Or, for a local circular velocity of 220 km/s</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vesc</span><span class="p">(</span><span class="n">MWPotential2014</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="mf">220.</span>
<span class="go">512.96057667432126</span>
</pre></div>
</div>
<p>similar to direct measurements of this (e.g., <a class="reference external" href="http://adsabs.harvard.edu/abs/2007MNRAS.379..755S">2007MNRAS.379..755S</a> and
<a class="reference external" href="http://adsabs.harvard.edu/abs/2014A%26A...562A..91P">2014A%26A...562A..91P</a>).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="potential.html" title="Potentials in galpy"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">galpy 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010 - 2014, Jo Bovy.
      Last updated on Dec 07, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>